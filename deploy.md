# Deploy frontend
1. Open the frontend directory
2. Run `npm install`
3. Run `npm run build` to create production build
4. Copy the files in the `build/` directory into `/var/www/html`
5. Install nginx onto the internet facing machine
6. Add the following to /etc/nginx/sites-available/default
```
server {
	#listen 80 default_server;
	#listen [::]:80 default_server;

	# SSL configuration
	listen 443 ssl;
	listen [::]:443 ssl;
	server_name lidar.icedcoffee.dev
	# ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
	ssl_protocols TLSv1.2 TLSv1.3;

	# Note: You should disable gzip for SSL traffic.
	# See: https://bugs.debian.org/773332
	gzip off;

	# Read up on ssl_ciphers to ensure a secure configuration.
	# See: https://bugs.debian.org/765782
	#
	# Self signed certs generated by the ssl-cert package
	# Don't use them in a production server!
	#
	# include snippets/snakeoil.conf;

	root /var/www/html;

	location /index.html {
		try_files $uri /index.html;
		add_header Cache-Control "no-store, no-cache, must-revalidate";
	}

	location /api {
		proxy_pass http://localhost:6000/;
	}

	location / {
		# Try files but resort to index if not found
		try_files $uri /index.html;
		# Cache for 1y as new names for static files https://rhazn.com/posts/build-a-progressive-web-app-in-docker-with-nginx-to-deploy-to-kubernetes-or-docker-swarm/
		expires 1y;
		add_header Cache-Control "public";
	}

    ssl_certificate /etc/letsencrypt/live/lidar.icedcoffee.dev/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/lidar.icedcoffee.dev/privkey.pem; # managed by Certbot
}


# Virtual Host configuration for example.com
#
# You can move that to a different file under sites-available/ and symlink that
# to sites-enabled/ to enable it.
#
server {
	listen 80 default_server;
	listen [::]:80 default_server;
	server_name _;
	return 301 https://$host$request_uri;
}

```
6. Start nginx

# Deploy login
1. Install the dependencies with
   `pip install Flask Flask-Cors pytest mysql-connector-python mysqlclient scrypt waitress`
2. Install latest version of mariadb
3. From the `Login/` directory run
```
echo "CREATE DATABASE Account" | sudo mysql -u root
sudo mysql -u root "Account" < database_schema2.sql
sudo mysql -u root "Account" < organisation_perm.sql
echo "CREATE USER aaa IDENTIFIED BY 'bbb';" | sudo mysql -u root
echo "GRANT ALL PRIVILEGES ON *.* TO 'aaa'@localhost IDENTIFIED BY 'bbb';" | sudo mysql -u root
```
2. Run Server.py

# Deploy Backend
1. Install latest version of mariadb
2. From `backend/lidar/` run
```
echo "CREATE DATABASE lidarDB" | sudo mysql -u root
sudo mysql -u root "lidarDB" < test_dump.sql
echo "CREATE USER aaa IDENTIFIED BY 'bbb';" | sudo mysql -u root
echo "GRANT ALL PRIVILEGES ON *.* TO 'aaa'@localhost IDENTIFIED BY 'bbb';" | sudo mysql -u root
```
3. Run `mvn compile exec:java`
